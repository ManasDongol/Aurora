@page "/"

<div class="container">

    <!-- Journal Entry -->
    <section class="card">
        <h2>Today's Journal Entry</h2>

        <div class="form-group">
            <label>Title</label>
            <input type="text" placeholder="Enter title..."
                   @bind="journaltitle"
                   class="text-input" />
        </div>

        <div class="form-group">
            <label>Content</label>
            <textarea rows="8" placeholder="Enter title..."
                      @bind="journaltext"
                      class="text-input"></textarea>
        </div>

        <select multiple class="multi-select" @onchange="OnMoodChange">
            @foreach (var state in _states)
            {
                <option value="@state">@state</option>
            }
        </select>

        <select multiple class="multi-select" @onchange="OnTagChange">
            @foreach (var state in _states)
            {
                <option value="@state">@state</option>
            }
        </select>

        <button class="primary-btn" @onclick="AddJournal">
            Enter
        </button>
    </section>

    <!-- Streak -->
    <section class="card streak">
        <h2>Streaks: @journals.Count</h2>
    </section>

    <h2 class="section-title">My Journals</h2>

    <!-- Journal List -->
    <section class="journal-grid">
        @foreach (var journal in journals)
        {
            <article class="card journal-card">
                <header>
                    <h3>@journal.Title</h3>
                    <small>@journal.DateVal.ToString("dd MMM yyyy")</small>
                </header>

                <div class="chip-group">
                    <strong>Moods:</strong>
                    @foreach (var mood in journal.Moods)
                    {
                        <span class="chip chip-primary">@mood</span>
                    }
                </div>

                <div class="chip-group">
                    <strong>Tags:</strong>
                    @foreach (var tag in journal.Tags)
                    {
                        <span class="chip chip-secondary">@tag</span>
                    }
                </div>

                <p>@journal.content</p>
            </article>
        }
    </section>

</div>
@code {

    public string journaltitle;
    public string journaltext;

    private List<string> selectedMoods = new();
    private List<string> selectedTags = new();

    public class journalcontent
    {
        public string Title { get; set; }
        public string content { get; set; }
        public DateTime DateVal { get; set; } = DateTime.UtcNow;
        public List<string> Moods { get; set; } = new();
        public List<string> Tags { get; set; } = new();
    }

    private readonly string[] _states =
    {
        "Happy","Excited","Relaxed","Grateful","Confident","Calm",
        "Thoughtful","Curious","Nostalgic","Bored","Sad","Angry",
        "Stressed","Lonely","Anxious"
    };

    public static List<journalcontent> journals = new();

    void AddJournal()
    {
        journals.Add(new journalcontent
        {
            Title = journaltitle,
            content = journaltext,
            Moods = selectedMoods.ToList(),
            Tags = selectedTags.ToList()
        });

        journaltitle = "";
        journaltext = "";
        selectedMoods.Clear();
        selectedTags.Clear();
    }

    void OnMoodChange(ChangeEventArgs e)
    {
        selectedMoods = ((IEnumerable<string>)e.Value)?.ToList() ?? new();
    }

    void OnTagChange(ChangeEventArgs e)
    {
        selectedTags = ((IEnumerable<string>)e.Value)?.ToList() ?? new();
    }
}

